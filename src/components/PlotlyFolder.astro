---
const plotFiles = Object.keys(
  import.meta.glob('/public/pulje_plots/*.html', { eager: true })
);

// Lav pæne labels + URLs
const plots = plotFiles.map(path => {
  const file = path.replace('/public', '');
  const name = file
    .split('/')
    .pop()
    .replace('.html', '')
    .replace('_gengangere', '')
    .replace('_lille_pulje', '')
    .replace(/[_-]/g, ' ');
  return { file, name };
});
---
<section class="plotly-wrapper">
  <label for="plot-select">Vælg række</label>
  <select id="plot-select">
    {plots.map((plot, i) => (
      <option value={plot.file} selected={i === 0}>
        {plot.name}
      </option>
    ))}
  </select>

  <div class="plot-frame">
    <iframe
      id="plot-iframe"
      src={plots[0]?.file}
      title="Plotly plot"
      loading="lazy"
    ></iframe>
  </div>
</section>

<script>
  const select = document.getElementById('plot-select');
  const iframe = document.getElementById('plot-iframe');

  select.addEventListener('change', () => {
    iframe.src = select.value;
  });
</script>

<style>
.plotly-wrapper {
  max-width: 1200px;
  margin: 2rem auto;
}

label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 600;
}

select {
  padding: 0.5rem 0.75rem;
  font-size: 1rem;
  margin-bottom: 1rem;
}

.plot-frame {
  width: 100%;
  height: 750px;
}

iframe {
  width: 100%;
  height: 100%;
  border: none;
}
</style>
